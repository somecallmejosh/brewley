<% if @product.available_on.present? && @product.discontinued_on.present? %>
  <% if (@product.discontinued_on.to_date - Date.today.to_date).to_i < 10 %>
    <div role="alert" class="p-6 font-semibold text-center text-red-800 rounded bg-gray-50">
      <p>**<%= @product.name %> will be discontinued in <%= (@product.discontinued_on.to_date - Date.today.to_date).to_i %> days!**</p>
    </div>
  <% end %>
<% end %>
<div class="pb-12 bg-white shadow-lg">
  <div class="<%= page_container_wide %>">
    <div>
      <%= render 'breadcrumbs', product: @product %>
    </div>
    <div class="flex flex-col gap-10 mb-8 lg:flex-row lg:justify-between lg:items-center">
      <div class="space-y-4">
        <%= link_to @product.category.name, category_path(@product.category), class: "bg-gray-900 text-white py-0.5 px-1.5 rounded text-xs tracking-widest font-semibold" %>
        <h1 class="text-4xl font-black lg:text-7xl">
          <%= @product.name %>
        </h1>
        <div class="prose">
          <%= @product.description %>
          <% if @product.available_on.present? && @product.discontinued_on.present? %>
            <p class="px-2 py-1 bg-gray-100 rounded"><%= @product.name %> is only available from <strong><%= @product.available_on.strftime("%b %d, %Y") %></strong> to <strong><%= @product.discontinued_on.strftime("%b %d, %Y") %></strong>.</p>
          <% end %>
        </div>
      </div>
      <div class="mb-6 space-y-6 lg:basis-96 lg:mb-0 lg:flex-shrink-0">
        <% if @product.product_variants.present? %>
          <h2 class="text-2xl font-semibold">Pricing</h2>
          <ul class="space-y-4">
            <% @product.product_variants.each do |variant|%>
              <li class="flex">
                <span><%= variant.name %></span>
                <span aria-hidden="true" role="presentation" class="flex-grow px-1 border-b border-dashed"></span>
                <span><%= number_to_currency(variant.price) %></span>
              </li>
            <% end %>
          </ul>
        <% end %>
        <div class="space-y-2">
          <div>
            <%= link_to "All #{@product.name} variants", product_product_variants_path(@product), class: button_class(theme: 'show', variant: 'x-small') %>
          </div>
          <div>
            <%= link_to "Add #{@product.name} variant", new_product_product_variant_path(@product), class: button_class(theme: 'new', variant: 'x-small') %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="<%= page_container %>">
  <% if notice.present? %>
    <p class="inline-block px-3 py-2 mb-5 font-medium text-green-500 rounded-lg bg-green-50" id="notice"><%= notice %></p>
  <% end %>
  <div>
    <%= render @product %>
  </div>
  <div>
    <%= link_to 'Edit this product', edit_product_path(@product), class: button_class(theme: 'update', variant: 'small') %>
    <%= link_to 'Back to products', products_path, class: button_class(theme: 'back', variant: 'small') %>
    <div class="inline-block">
      <%= button_to 'Destroy this product', product_path(@product), method: :delete, class: button_class(theme: 'destroy', variant: 'small') %>
    </div>
  </div>
</div>
